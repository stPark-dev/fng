{
  "name": "Fear & Greed Index Alert (Phase 1 - Sequential)",
  "nodes": [
    {
      "parameters": {
        "url": "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=usd",
        "options": {}
      },
      "id": "faad22be-d693-4504-8468-e91f83edb33f",
      "name": "Fetch Crypto Prices",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-2176, -320],
      "notes": "CoinGecko API: BTC, ETH Í∞ÄÍ≤© Ï°∞Ìöå"
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "fng_logs",
        "returnAll": true,
        "filters": {
          "conditions": [
            {
              "keyName": "timestamp",
              "condition": "gte",
              "keyValue": "={{ $now.setZone('Asia/Seoul').minus(7, 'days').startOf('day').toUTC().toISO() }}"
            }
          ]
        }
      },
      "id": "8dd09025-895f-4fa8-b10b-229433ed4ab3",
      "name": "Get Existing Dates",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [-2400, -80],
      "credentials": {
        "supabaseApi": {
          "id": "LgsTTjOAXDHsUcBL",
          "name": "Supabase account"
        }
      },
      "notes": "ÏµúÍ∑º 7Ïùº Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ Ï°∞Ìöå"
    },
    {
      "parameters": {
        "url": "https://api.alternative.me/fng/",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "7"
            }
          ]
        },
        "options": {
          "timeout": 10000
        }
      },
      "id": "0663d3cd-b4ae-4ff3-a8c7-d116fe435bee",
      "name": "Fetch FNG History",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-2176, -80],
      "notes": "ÏµúÍ∑º 7Ïùº FNG Îç∞Ïù¥ÌÑ∞ Ï°∞Ìöå"
    },
    {
      "parameters": {
        "jsCode": "/**\n * ÎàÑÎùΩÎêú ÎÇ†Ïßú Í∞êÏßÄ Î∞è Î∞±ÌïÑ Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ\n */\nconst existingData = $('Get Existing Dates').all();\nconst fngHistory = $('Fetch FNG History').first().json.data;\n\n// Í∏∞Ï°¥ ÎÇ†ÏßúÎ•º SetÏúºÎ°ú Î≥ÄÌôò (YYYY-MM-DD ÌòïÏãù)\nconst existingDates = new Set(\n  existingData.map(item => {\n    const d = new Date(item.json.timestamp);\n    return d.toISOString().split('T')[0];\n  })\n);\n\n// FNG Îç∞Ïù¥ÌÑ∞ÏóêÏÑú ÎàÑÎùΩÎêú ÎÇ†Ïßú Ï∞æÍ∏∞\nconst missingRecords = [];\nfor (const item of fngHistory) {\n  const timestamp = new Date(parseInt(item.timestamp, 10) * 1000);\n  const dateStr = timestamp.toISOString().split('T')[0];\n  \n  if (!existingDates.has(dateStr)) {\n    missingRecords.push({\n      json: {\n        value: parseInt(item.value, 10),\n        value_classification: item.value_classification,\n        timestamp: timestamp.toISOString(),\n        btc_price: null,\n        eth_price: null,\n        ai_comment: '[Backfilled]'\n      }\n    });\n  }\n}\n\nif (missingRecords.length === 0) {\n  return [{ json: { _no_missing: true, message: 'No missing dates found' } }];\n}\n\nconsole.log(`Found ${missingRecords.length} missing date(s)`);\nreturn missingRecords;"
      },
      "id": "bc5a874d-b2c3-4b14-811f-c785682f2dee",
      "name": "Find Missing Dates",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-1952, -80],
      "notes": "ÎàÑÎùΩÎêú ÎÇ†Ïßú Í∞êÏßÄ"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "check-no-missing",
              "leftValue": "={{ $json._no_missing === true }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "7951f146-217a-4d0b-9db1-9ac3ef54197a",
      "name": "Has Missing Data?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [-1728, -80]
    },
    {
      "parameters": {
        "tableId": "fng_logs",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "value",
              "fieldValue": "={{ $json.value }}"
            },
            {
              "fieldId": "value_classification",
              "fieldValue": "={{ $json.value_classification }}"
            },
            {
              "fieldId": "timestamp",
              "fieldValue": "={{ $json.timestamp }}"
            },
            {
              "fieldId": "btc_price",
              "fieldValue": "={{ $json.btc_price }}"
            },
            {
              "fieldId": "eth_price",
              "fieldValue": "={{ $json.eth_price }}"
            },
            {
              "fieldId": "ai_comment",
              "fieldValue": "={{ $json.ai_comment }}"
            }
          ]
        }
      },
      "id": "344695bd-6183-4026-807c-c3d850e661bc",
      "name": "Save Backfill Data",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [-1520, 16],
      "credentials": {
        "supabaseApi": {
          "id": "LgsTTjOAXDHsUcBL",
          "name": "Supabase account"
        }
      },
      "notes": "ÎàÑÎùΩ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•"
    },
    {
      "parameters": {},
      "id": "e68ac8a5-39b8-4f64-a9e1-8d2fd1692d9d",
      "name": "No Missing Data",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [-1520, -160]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": ""
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "contents",
              "value": "={{ [{\n  \"parts\": [{\n    \"text\": \"ÌòÑÏû¨ ÏïîÌò∏ÌôîÌèê ÏãúÏû• ÏÉÅÌô©Ïóê ÎåÄÌïú ÏßßÏùÄ Ïù∏ÏÇ¨Ïù¥Ìä∏Î•º ÌïúÍµ≠Ïñ¥Î°ú ÏûëÏÑ±Ìï¥Ï§ò. \\n\\nÎç∞Ïù¥ÌÑ∞:\\n- Í≥µÌè¨/ÌÉêÏöï ÏßÄÏàò: \" + $('Fetch FNG API1').first().json.data[0].value + \" (\" + $('Fetch FNG API1').first().json.data[0].value_classification + \")\\n- ÎπÑÌä∏ÏΩîÏù∏ Í∞ÄÍ≤©: $\" + $('Fetch Crypto Prices').first().json.bitcoin.usd + \"\\n- Ïù¥ÎçîÎ¶¨ÏõÄ Í∞ÄÍ≤©: $\" + $('Fetch Crypto Prices').first().json.ethereum.usd + \"\\n\\nÏ°∞Í±¥:\\n- 3Î¨∏Ïû• Ïù¥ÎÇ¥Î°ú ÏöîÏïΩ.\\n- Ìà¨Ïûê Ï°∞Ïñ∏Ï≤òÎüº Îì§Î¶¨Í≤å ÏûëÏÑ±.\\n- Ïù¥Î™®ÏßÄ 1~2Í∞ú ÏÇ¨Ïö©.\"\n  }]\n}] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "4e9dda5d-1f02-46d0-a60a-d0ce2b50cebd",
      "name": "Fetch Gemini Insight",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1952, -320],
      "notes": "Google Gemini Pro API Ìò∏Ï∂ú"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 9 * * *"
            }
          ]
        }
      },
      "id": "a9e191aa-6637-41be-bc5c-af951bab5d44",
      "name": "Daily 9AM KST1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [-2608, -320],
      "notes": "Îß§Ïùº Ïò§Ï†Ñ 9Ïãú(KST) Ïã§Ìñâ"
    },
    {
      "parameters": {
        "url": "https://api.alternative.me/fng/",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "2"
            }
          ]
        },
        "options": {
          "timeout": 10000
        }
      },
      "id": "bc3ca44c-1f78-4837-b4b2-5c2b75345f76",
      "name": "Fetch FNG API1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-2400, -320],
      "retryOnFail": true,
      "maxTries": 3,
      "notes": "Alternative.me API Ìò∏Ï∂ú"
    },
    {
      "parameters": {
        "jsCode": "/**\n * Fear & Greed Index - Transform & Alert Logic\n * Phase 1: Price & AI Insight Added\n * Modified to use detailed Zone Logic per user request\n */\n\nconst EMOJI_MAP = {\n  'Extreme Fear': 'üò±',\n  'Fear': 'üò®',\n  'Neutral': 'üòê',\n  'Greed': 'ü§ë',\n  'Extreme Greed': 'üöÄ',\n};\n\nconst unixToISO = (ts) => new Date(parseInt(ts, 10) * 1000).toISOString();\nconst safeParseInt = (val) => parseInt(val, 10) || 0;\nconst getEmoji = (cls) => EMOJI_MAP[cls] || 'üìä';\nconst getChangeEmoji = (c) => c > 0 ? 'üìà' : c < 0 ? 'üìâ' : '‚û°Ô∏è';\n\nconst getZoneMessage = (value) => {\n  if (value <= 10) {\n    return {\n      zone: 'üî• [Í≥µÌè¨ ÏßÄÏò•] 0-10',\n      title: 'Ìå®ÎãâÏÖÄ Ï†àÏ†ï! Ïò¨Ïù∏ ÌÉÄÏù¥Î∞ç?!',\n      tip: 'Ïó≠ÏÇ¨Ï†Å Î∞îÎã•Í∂å. ÏõåÎ†å Î≤ÑÌïè: \"ÎÇ®Îì§Ïù¥ Í≥µÌè¨Ïóê Îñ® Îïå ÌÉêÏöïÏùÑ Î∂ÄÎ†§Îùº\"\\n‚öîÔ∏è Ï†ÑÍµ∞ ÎèåÍ≤©! Î∂ÑÌï†Îß§Ïàò Ï†ÅÍ∑π Í≥†Î†§!',\n      emoji: 'ü©∏'\n    };\n  } else if (value <= 20) {\n    return {\n      zone: 'üò± [Í∑πÎã®Ï†Å Í≥µÌè¨] 11-20',\n      title: 'Í≥µÌè¨ Í∑πÎåÄÌôî! Îß§Ïàò Í∏∞Ìöå Ìè¨Ï∞©!',\n      tip: 'ÏãúÏû•Ïù¥ Í≥ºÎèÑÌïòÍ≤å ÎπÑÍ¥ÄÏ†Å. ÎåÄÎ∂ÄÎ∂ÑÏùò ÏïÖÏû¨Í∞Ä Í∞ÄÍ≤©Ïóê Î∞òÏòÅÎê®\\nüí∞ Ïö©Í∏∞ÏûàÎäî ÏûêÍ∞Ä Î∂ÄÎ•º ÏñªÎäîÎã§! Î∂ÑÌï†Îß§Ïàò ÏãúÏûë!',\n      emoji: 'üéØ'\n    };\n  } else if (value <= 30) {\n    return {\n      zone: 'üò® [Í≥µÌè¨] 21-30',\n      title: 'Í≥µÌè¨ Ïö∞ÏÑ∏! Îß§Ïàò Í¥ÄÏã¨ Íµ¨Í∞Ñ',\n      tip: 'ÏïÑÏßÅ ÎëêÎ†§ÏõÄÏù¥ ÏßÄÎ∞∞. Ï¢ãÏùÄ ÏûêÏÇ∞ÏùÑ Ïã∏Í≤å ÏÇ¥ Í∏∞Ìöå\\nüõí Í¥ÄÏã¨ Ï¢ÖÎ™© Î¶¨Ïä§Ìä∏ Ï†êÍ≤Ä, Î∂ÑÌï†Îß§Ïàò Ï§ÄÎπÑ!',\n      emoji: 'üëÄ'\n    };\n  } else if (value <= 40) {\n    return {\n      zone: 'üò∞ [ÏïΩÌïú Í≥µÌè¨] 31-40',\n      title: 'Î∂àÏïàÌïú ÏãúÏû•, Í∏∞Ìöå ÏóøÎ≥¥Í∏∞',\n      tip: 'ÏãúÏû• Ïã¨Î¶¨ ÏúÑÏ∂ï. ÏÑ£Î∂ÄÎ•∏ Îß§ÎèÑÎ≥¥Îã§ Í¥ÄÎßù or ÏÜåÎüâ Îß§Ïàò\\nüìù Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Ï†êÍ≤ÄÌïòÍ≥† Ï†ÄÍ∞Ä Îß§Ïàò Í∏∞Ìöå ÌÉêÏÉâ!',\n      emoji: 'üîç'\n    };\n  } else if (value <= 60) {\n    return {\n      zone: 'üòê [Ï§ëÎ¶Ω] 41-60',\n      title: 'Í∑†Ìòï ÏÉÅÌÉú, Í¥ÄÎßù Ï∂îÏ≤ú',\n      tip: 'ÎöúÎ†∑Ìïú Î∞©Ìñ•ÏÑ± ÏóÜÏùå. Ï∂îÏÑ∏ Ï†ÑÌôò Ïã†Ìò∏ Ï£ºÏãú\\n‚öñÔ∏è Í∏âÌïòÍ≤å ÏõÄÏßÅÏù¥ÏßÄ ÎßêÍ≥† ÏãúÏû• ÌùêÎ¶Ñ Í¥ÄÏ∞∞!',\n      emoji: '‚è≥'\n    };\n  } else if (value <= 70) {\n    return {\n      zone: 'üôÇ [ÏïΩÌïú ÌÉêÏöï] 61-70',\n      title: 'ÎÇôÍ¥ÄÎ°† ÌôïÏÇ∞, Ï£ºÏùò ÏãúÏûë',\n      tip: 'ÏãúÏû•Ïù¥ Í∏çÏ†ïÏ†Å. Ïã†Í∑ú Îß§ÏàòÎ≥¥Îã§ Î≥¥Ïú† Ï†ÑÎûµ Ïú†ÏßÄ\\nüìä Ï∂îÍ∞Ä Îß§ÏàòÎäî Ïã†Ï§ëÌïòÍ≤å, ÏùµÏ†à ÎùºÏù∏ ÏÑ§Ï†ï!',\n      emoji: 'üìà'\n    };\n  } else if (value <= 80) {\n    return {\n      zone: 'ü§ë [ÌÉêÏöï] 71-80',\n      title: 'Í≥ºÏó¥ Ïã†Ìò∏! Ï∞®ÏùµÏã§ÌòÑ Í≥†Î†§',\n      tip: 'FOMO Ï£ºÏùò! ÏßÄÍ∏à Îì§Ïñ¥Í∞ÄÎ©¥ Î¨ºÎ¶¥ Ïàò ÏûàÏùå\\nüíµ ÏàòÏùµ Ï§ëÏù∏ Ìè¨ÏßÄÏÖò ÏùºÎ∂Ä Ï†ïÎ¶¨ Í≥†Î†§!',\n      emoji: '‚ö†Ô∏è'\n    };\n  } else if (value <= 90) {\n    return {\n      zone: 'üöÄ [Í∑πÎã®Ï†Å ÌÉêÏöï] 81-90',\n      title: 'Î≤ÑÎ∏î Í≤ΩÍ≥†! ÏùµÏ†à ÌÉÄÏù¥Î∞ç!',\n      tip: 'ÏãúÏû• Í≥ºÏó¥ Ïã¨Í∞Å. Ïó≠ÏÇ¨Ï†ÅÏúºÎ°ú Ï°∞Ï†ï ÏûÑÎ∞ï Íµ¨Í∞Ñ\\nüõ°Ô∏è ÏàòÏùµ ÌôïÎ≥¥! ÌòÑÍ∏à ÎπÑÏ§ë ÌôïÎåÄ!',\n      emoji: 'üîî'\n    };\n  } else {\n    return {\n      zone: 'üí• [ÌÉêÏöï Í∑πÌïú] 91-100',\n      title: 'Ïú†Ìè¨Î¶¨ÏïÑ! ÌÉàÏ∂ú Ï§ÄÎπÑ!',\n      tip: 'Í∑πÎèÑÏùò ÎÇôÍ¥Ä. Ïù¥Îü∞ Îïå ÏÇ¨Î©¥ Í≥†Ï†êÏóê Î¨ºÎ¶∞Îã§\\nüö® Îß§ÎèÑ Ïã†Ìò∏! ÏöïÏã¨ Î≤ÑÎ¶¨Í≥† ÏàòÏùµ Ïã§ÌòÑ!',\n      emoji: 'üèÉ'\n    };\n  }\n};\n\ntry {\n  const fngNode = $('Fetch FNG API1').first();\n  const fngData = fngNode ? fngNode.json.data : null;\n  const priceNode = $('Fetch Crypto Prices').first();\n  const prices = priceNode ? priceNode.json : null;\n  \n  // Gemini Response Parsing\n  // Structure: candidates[0].content.parts[0].text\n  const geminiData = $input.item.json;\n  const aiComment = geminiData?.candidates?.[0]?.content?.parts?.[0]?.text || null;\n\n  if (!Array.isArray(fngData) || fngData.length < 2) {\n    throw new Error('Invalid FNG API response');\n  }\n\n  const todayRaw = fngData[0];\n  const yesterdayRaw = fngData[1];\n  const todayVal = safeParseInt(todayRaw.value);\n  const yesterdayVal = safeParseInt(yesterdayRaw.value);\n  const todayClassification = todayRaw.value_classification || 'Unknown';\n\n  const change = todayVal - yesterdayVal;\n  const changeEmoji = getChangeEmoji(change);\n  const changeSign = change >= 0 ? '+' : '';\n  const emoji = getEmoji(todayClassification);\n  const zoneInfo = getZoneMessage(todayVal);\n\n  const priceSection = (prices?.bitcoin?.usd && prices?.ethereum?.usd) \n      ? `\\nüí∞ *BTC*: $${prices.bitcoin.usd.toLocaleString()} | *ETH*: $${prices.ethereum.usd.toLocaleString()}` \n      : '';\n  const aiSection = aiComment ? `\\nü§ñ *AI Insight*:\\n_${aiComment}_` : '';\n\n  const alertMessage = [\n      `${zoneInfo.emoji} *${zoneInfo.zone}*`,\n      `*${zoneInfo.title}*`,\n      '',\n      `${emoji} *Fear & Greed Index*`,\n      '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ',\n      `üìä ÌòÑÏû¨ ÏßÄÏàò: *${todayVal}* (${todayClassification})`,\n      `${changeEmoji} Ï†ÑÏùº ÎåÄÎπÑ: *${changeSign}${change}*`,\n      `üìÖ Ïñ¥Ï†ú ÏßÄÏàò: ${yesterdayVal}`,\n      priceSection,\n      '',\n      `üí° *Ìà¨Ïûê ÌåÅ*`,\n      zoneInfo.tip,\n      aiSection\n    ].filter(Boolean).join('\\n');\n\n  return [{\n    json: {\n      value: todayVal,\n      value_classification: todayClassification,\n      timestamp: unixToISO(todayRaw.timestamp),\n      btc_price: prices?.bitcoin?.usd,\n      eth_price: prices?.ethereum?.usd,\n      ai_comment: aiComment,\n      should_alert: true,\n      alert_message: alertMessage,\n      change: change,\n    }\n  }];\n\n} catch (error) {\n  return [{\n    json: {\n      _error: true,\n      _error_message: error.message,\n      should_alert: false\n    }\n  }];\n}"
      },
      "id": "0f58b028-f9fc-450e-aeb0-0aa74ea403f8",
      "name": "Transform & Check Alert1",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-1728, -320],
      "notes": "Îç∞Ïù¥ÌÑ∞ Î≥ëÌï© Î∞è ÏïåÎ¶º Î°úÏßÅ"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $('Transform & Check Alert1').item.json.should_alert }}",
              "value2": true
            }
          ]
        },
        "options": {}
      },
      "id": "714c5ad5-f38c-4a9c-8825-2f534920f8db",
      "name": "Should Alert?1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [-848, -320]
    },
    {
      "parameters": {
        "chatId": "7267294735",
        "text": "={{ $('Transform & Check Alert1').item.json.alert_message }}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "3bc82c31-0bb8-463f-8bd5-ec861e5afe2c",
      "name": "Send Telegram Alert1",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [-576, -400],
      "webhookId": "b3f787cd-f341-43fb-911d-607fa176abd3",
      "credentials": {
        "telegramApi": {
          "id": "LGxnfMFceniDnlvc",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {},
      "id": "fd4e3de1-cd18-4fed-903d-aaac46c051b3",
      "name": "No Alert Needed1",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [-576, -208]
    },
    {
      "parameters": {
        "url": "=https://siauxjnsfhrssoxzfepv.supabase.co/rest/v1/fng_logs?timestamp=eq.{{ encodeURIComponent($json.timestamp) }}&select=id&limit=1",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNpYXV4am5zZmhyc3NveHpmZXB2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxMzE2NTIsImV4cCI6MjA3OTcwNzY1Mn0.jJu9S7aXc_6sjs26xLKKqjlUtyE-Z1EpCJzUb2QQELg"
            },
            {
              "name": "Authorization",
              "value": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNpYXV4am5zZmhyc3NveHpmZXB2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxMzE2NTIsImV4cCI6MjA3OTcwNzY1Mn0.jJu9S7aXc_6sjs26xLKKqjlUtyE-Z1EpCJzUb2QQELg"
            },
            {
              "name": "Prefer",
              "value": "return=representation"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "id": "be5c803a-7fde-4099-9940-f2fa7ad100b7",
      "name": "Check Today Exists",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1520, -320],
      "notes": "Ïò§Îäò Îç∞Ïù¥ÌÑ∞ Ï°¥Ïû¨ Ïó¨Î∂Ä ÌôïÏù∏"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "today-exists-check",
              "leftValue": "={{ $json.body.length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "02a371e8-85ee-4a8e-9fed-a3f2d4b7fa7a",
      "name": "Today Already Exists?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [-1296, -320]
    },
    {
      "parameters": {
        "tableId": "fng_logs",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "value",
              "fieldValue": "={{ $('Transform & Check Alert1').item.json.value }}"
            },
            {
              "fieldId": "value_classification",
              "fieldValue": "={{ $('Transform & Check Alert1').item.json.value_classification }}"
            },
            {
              "fieldId": "timestamp",
              "fieldValue": "={{ $('Transform & Check Alert1').item.json.timestamp }}"
            },
            {
              "fieldId": "btc_price",
              "fieldValue": "={{ $('Transform & Check Alert1').item.json.btc_price }}"
            },
            {
              "fieldId": "eth_price",
              "fieldValue": "={{ $('Transform & Check Alert1').item.json.eth_price }}"
            },
            {
              "fieldId": "ai_comment",
              "fieldValue": "={{ $('Transform & Check Alert1').item.json.ai_comment }}"
            }
          ]
        }
      },
      "id": "1c515daf-e7bd-4b42-ae01-87e4e4cda3b9",
      "name": "Save New Today Data",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [-1072, -176],
      "credentials": {
        "supabaseApi": {
          "id": "LgsTTjOAXDHsUcBL",
          "name": "Supabase account"
        }
      },
      "notes": "ÏÉà Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•"
    }
  ],
  "pinData": {},
  "connections": {
    "Fetch Crypto Prices": {
      "main": [
        [
          {
            "node": "Fetch Gemini Insight",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Gemini Insight": {
      "main": [
        [
          {
            "node": "Transform & Check Alert1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Daily 9AM KST1": {
      "main": [
        [
          {
            "node": "Fetch FNG API1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Existing Dates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Existing Dates": {
      "main": [
        [
          {
            "node": "Fetch FNG History",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch FNG History": {
      "main": [
        [
          {
            "node": "Find Missing Dates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find Missing Dates": {
      "main": [
        [
          {
            "node": "Has Missing Data?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Missing Data?": {
      "main": [
        [
          {
            "node": "No Missing Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Save Backfill Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch FNG API1": {
      "main": [
        [
          {
            "node": "Fetch Crypto Prices",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transform & Check Alert1": {
      "main": [
        [
          {
            "node": "Check Today Exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Today Exists": {
      "main": [
        [
          {
            "node": "Today Already Exists?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Today Already Exists?": {
      "main": [
        [
          {
            "node": "Should Alert?1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Save New Today Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save New Today Data": {
      "main": [
        [
          {
            "node": "Should Alert?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Should Alert?1": {
      "main": [
        [
          {
            "node": "Send Telegram Alert1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Alert Needed1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "d3985921-edf1-43fe-aa4d-8e9436e04895",
  "meta": {
    "instanceId": "bf5b63f78cbd4aaa159af6f3803643c7af3c2913652a6f9bc66354c394550d75"
  },
  "id": "wGkXiO6zkSxZoWX3",
  "tags": [
    {
      "updatedAt": "2025-11-26T06:09:52.079Z",
      "createdAt": "2025-11-26T06:09:52.079Z",
      "id": "f5mQorLT0rhfflHw",
      "name": "etl"
    },
    {
      "updatedAt": "2025-11-26T06:09:52.076Z",
      "createdAt": "2025-11-26T06:09:52.076Z",
      "id": "miQxlSkkt9DdjbHZ",
      "name": "crypto"
    }
  ]
}
